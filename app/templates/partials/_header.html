<header id="header">
    <nav>
        <!-- <i class="fa-solid fa-bars" id="icone-menu"></i> -->
        <div class="hamburger">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>

        <a href="{% url 'index' %}" class="logo">
            <i class="fa-solid fa-car"></i>
            <span class="destaque">Pezza</span><span>Ve√≠culos</span>
        </a>

        <ul class="navbar">
            <li class="nav-item">
                <a class="nav-link {% if request.path == '/' or request.path == '/index/' %}active{% else %}text-muted{% endif %}"
                    href="{% url 'index' %}">In√≠cio</a>
            </li>
            <li class="nav-item">
                <a class="nav-link {% if 'reciclagem' in request.path %}active{% else %}text-muted{% endif %}"
                    href="{% url 'reciclagem' %}">Reciclagem</a>
            </li>
            {% if user.is_authenticated %}
            <li class="nav-item">
                <a class="nav-link {% if 'consultar' in request.path %}active{% else %}text-muted{% endif %}"
                    href="{% url 'consultarfipe' %}">Consultar FIPE</a>
            </li>
            {% else %}
            <li class="nav-item">
                <a class="nav-link disabled" aria-disabled="true">Consultar FIPE</a>
            </li>
            {% endif %}
        </ul>
        <!-- Login e Logout -->
        <div class="d-flex align-items-center">
            {% if user.is_authenticated %}
            <div class="perfil-container">
                <button class="perfil-btn">
                    <i class="bi bi-person-circle me-1" style="color: var(--main);"></i>
                    <span class="nome-usuario">
                        {{ user.username }}

                        {% if user.is_authenticated and user.usuario.ocupacao == 'cliente' %}
                            {% if user.usuario.kgs_borracha_doados <= 50 %} ü•â
                            {% elif user.usuario.kgs_borracha_doados <= 100 %} ü•à
                            {% else %} ü•á
                        {% endif %}
                        {% endif %}
                    </span>
                    <i class="fa-solid fa-caret-down"></i>
                </button>
                <div class="dropdown-perfil">
                    <a href="{% url 'meu_perfil' %}" class="dropdown-item">
                        <i class="fa-solid fa-user"></i> Meu Perfil
                    </a>
                    <a href="{% url 'meus_agendamentos' %}" class="dropdown-item">
                        <i class="fa-solid fa-book"></i> Meus Agendamentos
                    </a>

                    <!-- Exclusivo para funcion√°rio e gerente -->
                    {% if user.is_authenticated and user.usuario.ocupacao in "funcionario,gerente" %}
                    <a href="{% url 'salvar_venda' %}" class="dropdown-item">
                        <i class="fa-solid fa-handshake"></i> Registrar venda
                    </a>
                    {% endif %}
                    <!-- Fim exclusivo para funcion√°rio e gerente -->

                    <!-- Exclusivo para gerente -->
                    {% if user.is_authenticated and user.usuario.ocupacao == "gerente" %}
                    <a href="#" class="dropdown-item submenu-toggle">
                        <i class="fa-solid fa-toolbox"></i> Ger√™ncia
                        <i class="fa-solid fa-caret-down float-end"></i>
                    </a>

                    <div class="submenu-gerencia">
                        <a href="{% url 'listas' %}" class="dropdown-subitem">
                            <i class="fa-solid fa-list"></i> Lista Geral
                        </a>
                        <a href="{% url 'criar_funcionario' %}" class="dropdown-subitem">
                            <i class="fa-solid fa-user-plus"></i> Criar Funcion√°rio
                        </a>
                        <a href="{% url 'criar_carro' %}" class="dropdown-subitem">
                            <i class="fa-solid fa-car-side"></i> Criar Carro
                        </a>
                    </div>
                    {% endif %}
                    <!-- Fim exclusivo para gerente -->

                    <div class="divisor"></div>
                    <form action="{% url 'logout' %}" method="post"
                        class="dropdown-item ps-3 pe-3 bg-transparent border-0">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-link p-0 text-start"> <!-- Classe "w-100" retirada pois estava dando conflito com o bootstrap -->
                            <i class="bi bi-box-arrow-right me-2"></i>Logout
                        </button>
                    </form>
                </div>
                {% else %}
                <li class="nav-item">
                    <a class="nav-link d-flex align-items-center py-0" href="{% url 'login' %}">
                        <div class="avatar-circle">
                            <i class="bi bi-person"></i>
                        </div>
                        <span class="ms-2">Login</span>
                    </a>
                </li>
                {% endif %}
            </div>
        </div>
    </nav>
</header>