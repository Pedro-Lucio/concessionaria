{% load static %}
{% load humanize %}

<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Concessionária{% endblock %}</title>
    <link rel="shortcut icon" href="https://img.icons8.com/?size=100&id=16694&format=png&color=228BE6"
        type="image/x-icon">
    <!-- Boostrap deve ser importado primeiro para que o estilo em cascata funcione corretamente -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    {% block extra_css %}{% endblock %}
    <link rel="stylesheet" href="{% static 'css/core/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/core/layout/header.css' %}">
    <link rel="stylesheet" href="{% static 'css/core/layout/footer.css' %}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link rel="stylesheet" href="static/css/pages/index.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: var(--main);
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --card-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin-top: 9.5vh;
        }

        section {
            min-height: 100vh;
        }

        /* Container com largura total */
        .container-fluid {
            padding-left: 30px;
            padding-right: 30px;
        }

        .card {
            border: none;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card-header {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 16px;
            border-bottom: none;
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .card-title i {
            color: var(--secondary-color);
        }

        .card-body {
            padding: 16px;
        }

        .btn-outline-secondary {
            border-radius: var(--border-radius);
            padding: 8px;
            width: 100%;
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #eee;
        }

        .form-group:last-of-type {
            border-bottom: none;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .form-group label i {
            color: var(--secondary-color);
            width: 16px;
        }

        .form-control {
            border-radius: 6px;
            border: 1px solid #ddd;
            padding: 6px 10px;
            font-size: 0.9rem;
        }

        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }

        /* Menu expansível para checkboxes */
        .filter-section {
            margin-bottom: 12px;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #e9ecef;
        }

        .filter-header {
            background-color: #f8f9fa;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }

        .filter-header:hover {
            background-color: #e9ecef;
        }

        .filter-title {
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-icon {
            transition: transform 0.3s;
        }

        .filter-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: white;
        }

        .filter-content.show {
            max-height: 200px;
            overflow-y: auto;
        }

        /* Checkbox groups melhor centralizadas */
        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 4px;
            padding: 10px 15px;
        }

        .form-check {
            margin-bottom: 4px;
            padding-left: 0;
            transition: background-color 0.2s;
            border-radius: 4px;
            padding: 6px 10px;
            display: flex;
            align-items: center;
        }

        .form-check:hover {
            background-color: rgba(52, 152, 219, 0.05);
        }

        /* Destaque para opções selecionadas */
        .form-check-input:checked+.form-check-label {
            color: var(--secondary-color);
            font-weight: 600;
        }

        .form-check-input:checked {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }

        .form-check-label {
            cursor: pointer;
            transition: color 0.2s;
            width: 100%;
            padding-left: 10px;
            font-size: 0.9rem;
            margin-bottom: 0;
        }

        /* Melhor alinhamento das checkboxes */
        .form-check-input {
            margin-top: 0;
            margin-right: 8px;
            flex-shrink: 0;
        }

        /* Área de resultados com flexbox */
        .results-area {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: flex-start;
        }

        .carro-card {
            flex: 0 0 calc(33.333% - 14px);
            transition: all 0.3s ease;
            margin-bottom: 0;
        }

        @media (max-width: 1200px) {
            .carro-card {
                flex: 0 0 calc(50% - 10px);
            }
        }

        @media (max-width: 768px) {
            .carro-card {
                flex: 0 0 100%;
            }

            .container-fluid {
                padding-left: 15px;
                padding-right: 15px;
            }
        }

        .carro-card .card {
            height: 100%;
            box-shadow: var(--card-shadow);
        }

        .carro-card .card-img-top {
            height: 180px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .carro-card:hover .card-img-top {
            transform: scale(1.03);
        }

        .carro-card .card-body {
            display: flex;
            flex-direction: column;
            padding: 16px;
        }

        /* MELHORIAS NOS CARDS - TÍTULO E SUBTÍTULO */
        .carro-card .card-title {
            font-size: 1.2rem;
            margin-bottom: 4px;
            color: var(--primary-color);
            font-weight: 700;
            line-height: 1.2;
        }

        .carro-card .card-subtitle {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .carro-card .preco {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .carro-card .btn {
            border-radius: 6px;
            padding: 8px 12px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .carro-card .btn-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }

        .carro-card .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }

        .carro-card .caracteristicas {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }

        .carro-card .caracteristica {
            background-color: #f8f9fa;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: #555;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .carro-card .caracteristica i {
            color: #666;
            font-size: 0.7rem;
        }

        .results-count {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 15px;
            padding: 10px 15px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
        }

        /* NOVOS ESTILOS PARA OS BOTÕES DE COMPARAR */
        .btn-comparar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .btn-comparar:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            color: white;
        }

        .btn-comparar-card {
            background: transparent;
            border: 2px solid #6c757d;
            color: #6c757d;
            font-weight: 500;
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-top: 8px;
            width: 100%;
        }

        .btn-comparar-card:hover {
            background: #6c757d;
            color: white;
            border-color: #6c757d;
        }

        .btn-comparar-card.active {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .card-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
    </style>
</head>

<body>
    {% include 'partials/_header.html' %}

    {% if messages %}
    <div class="messages" aria-live="polite" aria-atomic="true">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}" role="alert" data-duration="5000">
            <div class="alert-content">{{ message }}</div>
            <button class="msg-close" aria-label="Fechar">×</button>
            <div class="timer-bar"></div>
        </div>
        {% endfor %}
    </div>
    {% endif %}








    <!-- Acessível para PCD -->
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
    <script>
        new window.VLibras.Widget('https://vlibras.gov.br/app');
    </script>








    <section>
        {% include 'indexPartials/chat.html' %}

        {% include 'indexPartials/carousel.html' %}

        <!-- SEÇÃO ORIGINAL DE VEÍCULOS (agora com anchor) -->
        <div class="container-fluid my-4" id="veiculos">
            <div class="row">
                <div class="col-lg-3">
                    <div class="action-card sticky-top" style="top: calc(9.2vh + 20px); z-index: 0;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title">
                                    <i class="fas fa-filter"></i> Filtrar Veículos
                                </h5>
                            </div>
                            <div class="card-body">
                                <!-- Botão Comparar estilizado -->
                                <button type="button" class="btn btn-comparar w-100" id="btn-comparar-veiculos">
                                    <i class="fas fa-exchange-alt"></i>
                                    Comparar Veículos
                                </button>

                                <form id="filter-form">
                                    <!-- Filtro por Preço -->
                                    <div class="form-group">
                                        <label><i class="fas fa-tag"></i> Preço</label>
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="number" class="form-control" id="valorMin" name="valorMin"
                                                    placeholder="Mín." min="0">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control" id="valorMax" name="valorMax"
                                                    placeholder="Máx." min="0">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Filtro por Ano -->
                                    <div class="form-group">
                                        <label><i class="fas fa-calendar-alt"></i> Ano</label>
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="number" class="form-control" id="ano_min" name="ano_min"
                                                    placeholder="De" min="1990" max="2023">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control" id="ano_max" name="ano_max"
                                                    placeholder="Até" min="1990" max="2023">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Filtro por Quilometragem -->
                                    <div class="form-group">
                                        <label for="km_max"><i class="fas fa-tachometer-alt"></i> Km máxima</label>
                                        <input type="number" class="form-control" id="km_max" name="km_max"
                                            placeholder="Ex: 50000">
                                    </div>

                                    <!-- Menu expansível para Marca -->
                                    <div class="filter-section">
                                        <div class="filter-header" data-toggle="marca">
                                            <div class="filter-title">
                                                <i class="fas fa-car"></i> Marca
                                            </div>
                                            <i class="fas fa-chevron-down filter-icon"></i>
                                        </div>
                                        <div class="filter-content" id="marca-content">
                                            <div class="checkbox-group">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Chevrolet"
                                                        name="marca" value="Chevrolet">
                                                    <label class="form-check-label"
                                                        for="marca-Chevrolet">Chevrolet</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Fiat"
                                                        name="marca" value="Fiat">
                                                    <label class="form-check-label" for="marca-Fiat">Fiat</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Ford"
                                                        name="marca" value="Ford">
                                                    <label class="form-check-label" for="marca-Ford">Ford</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Honda"
                                                        name="marca" value="Honda">
                                                    <label class="form-check-label" for="marca-Honda">Honda</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Hyundai"
                                                        name="marca" value="Hyundai">
                                                    <label class="form-check-label" for="marca-Hyundai">Hyundai</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Jeep"
                                                        name="marca" value="Jeep">
                                                    <label class="form-check-label" for="marca-Jeep">Jeep</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Nissan"
                                                        name="marca" value="Nissan">
                                                    <label class="form-check-label" for="marca-Nissan">Nissan</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Peugeot"
                                                        name="marca" value="Peugeot">
                                                    <label class="form-check-label" for="marca-Peugeot">Peugeot</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Renault"
                                                        name="marca" value="Renault">
                                                    <label class="form-check-label" for="marca-Renault">Renault</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Toyota"
                                                        name="marca" value="Toyota">
                                                    <label class="form-check-label" for="marca-Toyota">Toyota</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="marca-Volkswagen" name="marca" value="Volkswagen">
                                                    <label class="form-check-label"
                                                        for="marca-Volkswagen">Volkswagen</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Audi"
                                                        name="marca" value="Audi">
                                                    <label class="form-check-label" for="marca-Audi">Audi</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-BMW"
                                                        name="marca" value="BMW">
                                                    <label class="form-check-label" for="marca-BMW">BMW</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="marca-Mercedes"
                                                        name="marca" value="Mercedes-Benz">
                                                    <label class="form-check-label"
                                                        for="marca-Mercedes">Mercedes-Benz</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Menu expansível para Tipo -->
                                    <div class="filter-section">
                                        <div class="filter-header" data-toggle="tipo">
                                            <div class="filter-title">
                                                <i class="fas fa-shapes"></i> Tipo
                                            </div>
                                            <i class="fas fa-chevron-down filter-icon"></i>
                                        </div>
                                        <div class="filter-content" id="tipo-content">
                                            <div class="checkbox-group">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="tipo-Hatch"
                                                        name="tipo" value="Hatch">
                                                    <label class="form-check-label" for="tipo-Hatch">Hatch</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="tipo-Sedan"
                                                        name="tipo" value="Sedan">
                                                    <label class="form-check-label" for="tipo-Sedan">Sedan</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="tipo-SUV"
                                                        name="tipo" value="SUV">
                                                    <label class="form-check-label" for="tipo-SUV">SUV</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="tipo-Picape"
                                                        name="tipo" value="Picape">
                                                    <label class="form-check-label" for="tipo-Picape">Picape</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="tipo-Esportivo"
                                                        name="tipo" value="Esportivo">
                                                    <label class="form-check-label"
                                                        for="tipo-Esportivo">Esportivo</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Menu expansível para Câmbio -->
                                    <div class="filter-section">
                                        <div class="filter-header" data-toggle="cambio">
                                            <div class="filter-title">
                                                <i class="fas fa-cogs"></i> Câmbio
                                            </div>
                                            <i class="fas fa-chevron-down filter-icon"></i>
                                        </div>
                                        <div class="filter-content" id="cambio-content">
                                            <div class="checkbox-group">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cambio-Manual"
                                                        name="cambio" value="Manual">
                                                    <label class="form-check-label" for="cambio-Manual">Manual</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="cambio-Automatico" name="cambio" value="Automático">
                                                    <label class="form-check-label"
                                                        for="cambio-Automatico">Automático</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="cambio-Sequencial" name="cambio"
                                                        value="Automático Sequencial">
                                                    <label class="form-check-label" for="cambio-Sequencial">Automático
                                                        Sequencial</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cambio-CVT"
                                                        name="cambio" value="CVT">
                                                    <label class="form-check-label" for="cambio-CVT">CVT</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Menu expansível para Combustível -->
                                    <div class="filter-section">
                                        <div class="filter-header" data-toggle="combustivel">
                                            <div class="filter-title">
                                                <i class="fas fa-gas-pump"></i> Combustível
                                            </div>
                                            <i class="fas fa-chevron-down filter-icon"></i>
                                        </div>
                                        <div class="filter-content" id="combustivel-content">
                                            <div class="checkbox-group">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="combustivel-Gasolina" name="combustivel" value="Gasolina">
                                                    <label class="form-check-label"
                                                        for="combustivel-Gasolina">Gasolina</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="combustivel-Alcool" name="combustivel" value="Álcool">
                                                    <label class="form-check-label"
                                                        for="combustivel-Alcool">Álcool</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="combustivel-Flex" name="combustivel" value="Flex">
                                                    <label class="form-check-label" for="combustivel-Flex">Flex</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="combustivel-Diesel" name="combustivel" value="Diesel">
                                                    <label class="form-check-label"
                                                        for="combustivel-Diesel">Diesel</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="combustivel-Hibrido" name="combustivel" value="Híbrido">
                                                    <label class="form-check-label"
                                                        for="combustivel-Hibrido">Híbrido</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="combustivel-Eletrico" name="combustivel" value="Elétrico">
                                                    <label class="form-check-label"
                                                        for="combustivel-Eletrico">Elétrico</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Menu expansível para Cor -->
                                    <div class="filter-section">
                                        <div class="filter-header" data-toggle="cor">
                                            <div class="filter-title">
                                                <i class="fas fa-palette"></i> Cor
                                            </div>
                                            <i class="fas fa-chevron-down filter-icon"></i>
                                        </div>
                                        <div class="filter-content" id="cor-content">
                                            <div class="checkbox-group">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Branco"
                                                        name="cor" value="Branco">
                                                    <label class="form-check-label" for="cor-Branco">Branco</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Preto"
                                                        name="cor" value="Preto">
                                                    <label class="form-check-label" for="cor-Preto">Preto</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Prata"
                                                        name="cor" value="Prata">
                                                    <label class="form-check-label" for="cor-Prata">Prata</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Cinza"
                                                        name="cor" value="Cinza">
                                                    <label class="form-check-label" for="cor-Cinza">Cinza</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Vermelho"
                                                        name="cor" value="Vermelho">
                                                    <label class="form-check-label" for="cor-Vermelho">Vermelho</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Azul"
                                                        name="cor" value="Azul">
                                                    <label class="form-check-label" for="cor-Azul">Azul</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Verde"
                                                        name="cor" value="Verde">
                                                    <label class="form-check-label" for="cor-Verde">Verde</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Amarelo"
                                                        name="cor" value="Amarelo">
                                                    <label class="form-check-label" for="cor-Amarelo">Amarelo</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Laranja"
                                                        name="cor" value="Laranja">
                                                    <label class="form-check-label" for="cor-Laranja">Laranja</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Marrom"
                                                        name="cor" value="Marrom">
                                                    <label class="form-check-label" for="cor-Marrom">Marrom</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Bege"
                                                        name="cor" value="Bege">
                                                    <label class="form-check-label" for="cor-Bege">Bege</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="cor-Dourado"
                                                        name="cor" value="Dourado">
                                                    <label class="form-check-label" for="cor-Dourado">Dourado</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button type="button" id="reset-filters" class="btn btn-outline-secondary mt-3">
                                        <i class="fas fa-times me-2"></i> Limpar Filtros
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Área de resultados -->
                <div class="col-lg-9">
                    <div class="card mb-4">
                        <div class="card-body">
                            <h4>Veículos Disponíveis</h4>
                            <div class="results-count" id="results-count">Mostrando <span id="count">{{ carros|length
                                    }}</span> de <span id="total">{{ carros|length }}</span> veículos</div>

                            <!-- Cards dos carros com flexbox -->
                            <div class="results-area" id="carros-container">
                                {% for carro in carros %}
                                {% if carro.ativo == True %}
                                <div class="carro-card" data-marca="{{ carro.marca }}" data-cor="{{ carro.cor }}"
                                    data-tipo="{{ carro.tipo }}" data-cambio="{{ carro.cambio }}"
                                    data-combustivel="{{ carro.combustivel }}" data-valor="{{ carro.valor }}"
                                    data-ano="{{ carro.ano }}" data-km="{{ carro.km }}">
                                    <div class="card h-100">
                                        <img src="{{ carro.imagens.first.foto_url }}" class="card-img-top"
                                            alt="{{ carro.modelo }}">
                                        <div class="card-body">
                                            <!-- TÍTULO E SUBTÍTULO MELHORADOS -->
                                            <h5 class="card-title">{{ carro.marca }} {{ carro.modelo }}</h5>
                                            <div class="card-subtitle">{{ carro.motor }} • {{ carro.cambio }} • {{ carro.combustivel }}</div>

                                            <div class="caracteristicas">
                                                <span class="caracteristica">
                                                    <i class="fas fa-calendar-alt"></i> {{ carro.ano }}
                                                </span>
                                                <span class="caracteristica">
                                                    <i class="fas fa-tachometer-alt"></i> {{ carro.km|intcomma }} km
                                                </span>
                                            </div>

                                            <!-- Preço formatado sem centavos -->
                                            <div class="preco">R$ {{ carro.valor|floatformat:0|intcomma }}</div>

                                            <!-- Botões em coluna -->
                                            <div class="card-buttons">
                                                <a href="{% url 'detalhes' carro.id %}" class="btn btn-primary">Ver
                                                    Detalhes</a>
                                                <a href="#" class="btn btn-comparar-card" data-id="{{ carro.id }}">
                                                    <i class="fas fa-exchange-alt"></i> Comparar
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    {% include 'partials/_footer.html' %}

    <!-- COMPARAR -->
    <!-- Modal de Comparação -->
    <div class="modal fade" id="compararModal" tabindex="-1" aria-labelledby="compararModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="compararModalLabel">Comparação de Veículos</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    Selecione dois carros para comparar.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>

    <script src="{% static 'js/core/main.js' %}"></script>
    <script src="../../static/js/pages/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Interatividade com os filtros
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('filter-form');
            const resetBtn = document.getElementById('reset-filters');
            const carrosCards = document.querySelectorAll('.carro-card');
            const filterInputs = document.querySelectorAll('#filter-form input');
            const countElement = document.getElementById('count');
            const totalElement = document.getElementById('total');
            const compararButtons = document.querySelectorAll('.btn-comparar-card');
            const btnCompararVeiculos = document.getElementById('btn-comparar-veiculos');
            const marcaItems = document.querySelectorAll('.marca-item');

            // Inicializar contador
            const totalCards = carrosCards.length;
            totalElement.textContent = totalCards;
            countElement.textContent = totalCards;

            // Função para obter valores selecionados dos checkboxes
            function getCheckedValues(name) {
                const checkboxes = document.querySelectorAll(`input[name="${name}"]:checked`);
                return Array.from(checkboxes).map(cb => cb.value.toLowerCase());
            }

            // Função para aplicar os filtros
            function aplicarFiltros() {
                const marcasSelecionadas = getCheckedValues('marca');
                const coresSelecionadas = getCheckedValues('cor');
                const tiposSelecionados = getCheckedValues('tipo');
                const cambiosSelecionados = getCheckedValues('cambio');
                const combustiveisSelecionados = getCheckedValues('combustivel');

                const valorMin = parseFloat(document.getElementById('valorMin').value) || 0;
                const valorMax = parseFloat(document.getElementById('valorMax').value) || Infinity;
                const anoMin = parseInt(document.getElementById('ano_min').value) || 0;
                const anoMax = parseInt(document.getElementById('ano_max').value) || Infinity;
                const kmMax = parseInt(document.getElementById('km_max').value) || Infinity;

                let visibleCount = 0;

                carrosCards.forEach(card => {
                    const cardMarca = card.dataset.marca.toLowerCase();
                    const cardCor = card.dataset.cor.toLowerCase();
                    const cardTipo = card.dataset.tipo.toLowerCase();
                    const cardCambio = card.dataset.cambio.toLowerCase();
                    const cardCombustivel = card.dataset.combustivel.toLowerCase();
                    const cardValor = parseFloat(card.dataset.valor);
                    const cardAno = parseInt(card.dataset.ano);
                    const cardKm = parseInt(card.dataset.km);

                    // Verificar seleções (se nenhum checkbox foi marcado, mostra todos)
                    const marcaMatch = marcasSelecionadas.length === 0 || marcasSelecionadas.includes(cardMarca);
                    const corMatch = coresSelecionadas.length === 0 || coresSelecionadas.includes(cardCor);
                    const tipoMatch = tiposSelecionados.length === 0 || tiposSelecionados.includes(cardTipo);
                    const cambioMatch = cambiosSelecionados.length === 0 || cambiosSelecionados.includes(cardCambio);
                    const combustivelMatch = combustiveisSelecionados.length === 0 || combustiveisSelecionados.includes(cardCombustivel);

                    // Verificar faixas
                    const valorMatch = cardValor >= valorMin && cardValor <= valorMax;
                    const anoMatch = cardAno >= anoMin && cardAno <= anoMax;
                    const kmMatch = cardKm <= kmMax;

                    if (marcaMatch && corMatch && tipoMatch && cambioMatch && combustivelMatch &&
                        valorMatch && anoMatch && kmMatch) {
                        card.style.display = 'block';
                        visibleCount++;
                    } else {
                        card.style.display = 'none';
                    }
                });

                // Atualizar contador
                countElement.textContent = visibleCount;
            }

            // Aplicar filtros automaticamente quando qualquer input muda
            filterInputs.forEach(input => {
                if (input.type === 'checkbox') {
                    // Para checkboxes, prevenir comportamento padrão e controlar o scroll
                    input.addEventListener('click', function (e) {
                        // Aplicar filtros sem causar scroll
                        aplicarFiltros();
                    });
                } else {
                    input.addEventListener('change', aplicarFiltros);
                    if (input.type === 'number') {
                        input.addEventListener('input', function (e) {
                            // Atraso para evitar filtragem a cada tecla pressionada
                            clearTimeout(this.timer);
                            this.timer = setTimeout(aplicarFiltros, 500);
                        });
                    }
                }
            });

            // Evento de reset dos filtros
            resetBtn.addEventListener('click', function () {
                // Resetar todos os inputs
                form.reset();
                // Aplicar filtros para mostrar todos os carros
                aplicarFiltros();
            });

            // Aplicar filtros ao carregar a página se houver parâmetros na URL
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.toString()) {
                // Preencher os campos do formulário com os parâmetros da URL
                urlParams.forEach((value, key) => {
                    if (key === 'marca' || key === 'cor' || key === 'tipo' || key === 'cambio' || key === 'combustivel') {
                        // Para checkboxes, marcar os valores separados por vírgula
                        const values = value.split(',');
                        values.forEach(val => {
                            const checkbox = document.querySelector(`input[name="${key}"][value="${val}"]`);
                            if (checkbox) checkbox.checked = true;
                        });
                    } else {
                        const element = document.getElementById(key);
                        if (element) element.value = value;
                    }
                });

                // Aplicar os filtros
                aplicarFiltros();
            }

            // Menu expansível para os filtros
            document.querySelectorAll('.filter-header').forEach(header => {
                header.addEventListener('click', function () {
                    const targetId = this.getAttribute('data-toggle');
                    const content = document.getElementById(`${targetId}-content`);
                    const icon = this.querySelector('.filter-icon');

                    content.classList.toggle('show');

                    if (content.classList.contains('show')) {
                        icon.style.transform = 'rotate(180deg)';
                    } else {
                        icon.style.transform = 'rotate(0deg)';
                    }
                });
            });

            // Lógica para os botões de comparar
            let carrosSelecionados = [];

            compararButtons.forEach(button => {
                button.addEventListener('click', function (e) {
                    e.preventDefault();
                    const carroId = this.getAttribute('data-id');

                    if (this.classList.contains('active')) {
                        // Remover da seleção
                        this.classList.remove('active');
                        carrosSelecionados = carrosSelecionados.filter(id => id !== carroId);
                    } else {
                        // Adicionar à seleção (máximo 2 carros)
                        if (carrosSelecionados.length < 2) {
                            this.classList.add('active');
                            carrosSelecionados.push(carroId);
                        } else {
                            alert('Você só pode comparar 2 veículos por vez.');
                        }
                    }

                    // Atualizar o botão principal de comparar
                    if (carrosSelecionados.length === 2) {
                        btnCompararVeiculos.textContent = `Comparar ${carrosSelecionados.length} veículos`;
                    } else {
                        btnCompararVeiculos.innerHTML = '<i class="fas fa-exchange-alt"></i> Comparar Veículos';
                    }
                });
            });

            // Botão principal de comparar
            btnCompararVeiculos.addEventListener('click', function () {
                if (carrosSelecionados.length === 2) {
                    // Redirecionar para página de comparação ou abrir modal
                    window.location.href = `/comparar/?carro1=${carrosSelecionados[0]}&carro2=${carrosSelecionados[1]}`;
                } else {
                    alert('Selecione 2 veículos para comparar.');
                }
            });

            // Lógica para as marcas - filtro por marca ao clicar
            marcaItems.forEach(item => {
                item.addEventListener('click', function () {
                    const marca = this.getAttribute('data-marca');

                    // Desmarcar todas as checkboxes de marca primeiro
                    document.querySelectorAll('input[name="marca"]').forEach(checkbox => {
                        checkbox.checked = false;
                    });

                    // Marcar a checkbox da marca selecionada
                    const marcaCheckbox = document.querySelector(`input[name="marca"][value="${marca}"]`);
                    if (marcaCheckbox) {
                        marcaCheckbox.checked = true;
                    }

                    // Aplicar filtros
                    aplicarFiltros();

                    // Rolar suavemente para a seção de veículos
                    document.getElementById('veiculos').scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        });
    </script>
</body>

</html>